---
title: "Zillow Data Scientist Challenge Appendix 1: Mapping"
author: "Zhihang Dong"
date: "12/17/2017"
output: html_document
always_allow_html: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Introduction

This appendix introduces the uses of leaflet \texttt{R} package to demonstrate the abilities to do interactive mapping. At the end, I also showcased the use of \texttt{data.table} on interactive sales records data querying.

## Load the Required Data and Package

```{r}
library("data.table")
library("DT")
library("htmltools")
library("leaflet")
library("tidyverse")
train_df <- fread("training_CONFIDENTIAL.csv", showProgress=FALSE)
```

## Leaflet and Interactive Mapping


```{r}
train_df[, 
         list(label=HTML(paste(sep="<br>",paste("Bedrooms:", BedroomCnt),
                               paste("Bathrooms:", BathroomCnt),
                               paste("Total area:", FinishedSquareFeet),
                               paste("Sales Price: $", SaleDollarCnt)))), 
       list(Longitude, Latitude)] %>% leaflet() %>% addTiles() %>%addCircleMarkers(
         lat =  ~ Latitude / 1e6,
         lng =  ~ Longitude / 1e6,
         label = ~label,
         clusterOptions = markerClusterOptions()
         )
```

## Including Plots

Then, we use the \texttt{data.table} function to work out an interactive query table to see how many houses are built in which year, and the mean and standard deviation of their prices.

```{r}
train_df[, list(n=.N, Mean.Price=mean(SaleDollarCnt), SD.Price=sd(SaleDollarCnt)),
         by=BuiltYear] %>%round(3) %>% datatable()
```


